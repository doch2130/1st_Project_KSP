<!DOCTYPE html>
<html lang="en, ko">
<head>
    <%- include('./common/Head_CDN') %>
    <link href="/static/css/readBoard.css" rel="stylesheet" />
</head>
<body class="sb-nav-fixed">
    <section>
        <!-- topNavbar -->
        <%- include('./common/topNavbar') %>
    </section>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <!-- sideNavbar -->
            <%- include('./common/sideNavbar') %>
        </div>

        <div id="layoutSidenav_content">
            <!-- 본문 데이터 -->
            <div class="background_all row">
                <div class="board_wrap col-12">
                    <div style="color: white;" class="board_t">자유게시판</div>
                    <div class="board_view_wrap">
                        <div class="board_view">
                            <div class="title">
                                <%=data.title%>
                            </div>
                            <div class="info">
                                <dl>
                                    <dt>번호</dt>
                                    <dd><%=data.number%></dd>
                                </dl>
                                <dl> 
                                    <dt>글쓴이</dt>
                                    <dd><%=data.id%></dd>
                                </dl>
                                <dl>
                                    <dt>작성일</dt> 
                                    <dd><%=data.date.toLocaleDateString()%></dd>
                                </dl>
                                <dl>
                                    <dt>조회</dt>
                                    <dd><%=data.hit%></dd>
                                </dl>
                            </div>
                            <div class="cont">
                                <pre style="font-size: 1.5rem; margin: 0px;"><%=data.content%></pre>
                                <br />
                            <% if ( data.filename != null ) { %>
                                    <% if ( data.filename.includes(".png") || data.filename.includes(".jpg")) { %>
                                <div class="img" style="width: 50%;">
                                    <img src="/static/res/board/<%=data.filename%>" width="70%" />
                                </div>
                                    <% } %>
                            <% } %>
                            </div>
                            <!-- 만약에 data의 파일이름이 null이 아니고,
                                date의 파일네임에 png가 들어있거나또는 data의 파일네임에 jpg가 들어있으면
                                div class=img 태그를 보여줘라! -->

                            <% if ( data.filename != null ) { %>
                                <a href="/static/res/board/<%=data.filename%>" target="_blank"><%=data.filename%></a> 
                            <% } %>
                            <!-- 만약에, data의 파일이름이 null이 아니면,
                                data의 파일을 보여주는 페이지를 열리게 하는 링크 -->
                        </div>
                        <div class="bt_wrap">
                            <% if ( result.id == data.id && result.isLogin ) {  %>
                                <button type="button" class="btn btn-outline-secondary" id="btn_correct" onclick="document.location.href='/board/update?number=<%=data.number%>'">수정</button>
                                <button type="button" class="btn btn-outline-secondary" id="btn_delete" onclick="delete_Board();">삭제</button>
                            <% } %>
                            <button type="button" class="btn btn-outline-secondary" id="btn_cancel" onclick="document.location.href='/board'">목록</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 로그인, 로그아웃 버튼 보여주기 & 로그아웃 기능 -->
    <%- include('./common/topLoginBtn.ejs') %>

    <script type="text/javascript">
        function delete_Board() {
            let user = {
                number: "<%=data.number%>"
            };
            
            if ( !"<%=result.isLogin%>" ) {
                alert( "로그인 하십시오" ); 
                document.location.href='/login';
            }
            axios({
                method: 'delete',
                url: '/board/delete',
                data: user
            })
            .then((rep) => {
                return rep.data;
            })
            .then((data) => {
                if( data ) {
                    alert( "글 삭제가 완료되었습니다." );
                    document.location.href='/board';
                } else {
                    alert( "알 수 없는 문제가 발생했습니다." );
                }
            });
        }
    </script>
    
</body>
</html>
